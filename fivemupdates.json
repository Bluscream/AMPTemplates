[
    {
        "UpdateStageName":"Create Server Directory",
        "UpdateSourcePlatform":"All",
        "UpdateSource":"CreateDirectory",
        "UpdateSourceArgs":"{{$FullBaseDir}}server",
        "OverwriteExistingFiles":false
    },
    {
        "UpdateStageName":"Create Data Directory",
        "UpdateSourcePlatform":"All",
        "UpdateSource":"CreateDirectory",
        "UpdateSourceArgs":"{{$FullBaseDir}}server-data",
        "OverwriteExistingFiles":false
    },
    {
        "UpdateStageName":"Delete Binary Directory Contents",
        "UpdateSourcePlatform":"Linux",
        "UpdateSource":"Executable",
        "UpdateSourceData":"/bin/bash",
        "UpdateSourceArgs":"-c 'rm -rf {{$FullBaseDir}}server/alpine/*'"
    },
    {
        "UpdateStageName":"Delete Binary Directory Contents",
        "UpdateSourcePlatform":"Windows",
        "UpdateSource":"Executable",
        "UpdateSourceData":"cmd.exe",
        "UpdateSourceArgs":"/C del /Q /F {{$FullBaseDir}}server\\alpine\\*"
    },
    {
        "UpdateStageName":"Server Download",
        "UpdateSourcePlatform":"Windows",
        "UpdateSource":"FetchURLFromJQ",
        "UpdateSourceData":"https://changelogs-live.fivem.net/api/changelog/versions/windows/server",
        "UpdateSourceArgs":"$.{{ServerBuild}}",
        "UpdateSourceTarget":"{{$FullBaseDir}}server",
        "UnzipUpdateSource":true,
        "OverwriteExistingFiles":true,
        "DeleteAfterExtract":true
    },
    {
        "UpdateStageName":"Server Download",
        "UpdateSourcePlatform":"Linux",
        "UpdateSource":"FetchURLFromJQ",
        "UpdateSourceData":"https://changelogs-live.fivem.net/api/changelog/versions/linux/server",
        "UpdateSourceArgs":"$.{{ServerBuild}}",
        "UpdateSourceTarget":"{{$FullBaseDir}}server",
        "UnzipUpdateSource":false,
        "OverwriteExistingFiles":true
    },
    {
        "UpdateStageName":"Server Download",
        "UpdateSourcePlatform":"Windows",
        "UpdateSource":"FetchURL",
        "UpdateSourceData":"https://runtime.fivem.net/artifacts/fivem/build_server_windows/master/{{SpecificBuildVersion}}/server.7z",
        "UpdateSourceTarget":"{{$FullBaseDir}}server",
        "UnzipUpdateSource":true,
        "OverwriteExistingFiles":true,
        "DeleteAfterExtract":true,
        "UpdateSourceConditionSetting":"ServerBuild",
        "UpdateSourceConditionValue":"SpecificVersion",
    },
    {
        "UpdateStageName":"Server Download",
        "UpdateSourcePlatform":"Linux",
        "UpdateSource":"FetchURL",
        "UpdateSourceData":"https://runtime.fivem.net/artifacts/fivem/build_proot_linux/master/{{SpecificBuildVersion}}/fx.tar.xz",
        "UpdateSourceTarget":"{{$FullBaseDir}}server",
        "UnzipUpdateSource":false,
        "OverwriteExistingFiles":true,
        "UpdateSourceConditionSetting":"ServerBuild",
        "UpdateSourceConditionValue":"SpecificVersion",
    },
    {
        "UpdateStageName":"Server Extract",
        "UpdateSourcePlatform":"Linux",
        "UpdateSource":"Executable",
        "UpdateSourceData":"/bin/bash",
        "UpdateSourceArgs":"-c 'cd ./fivem/server && tar -xf fx.tar.xz && rm -f fx.tar.xz'"
    },
    {
        "UpdateStageName":"Clone cfx-server-data Repo",
        "UpdateSourcePlatform":"All",
        "UpdateSource":"GitRepo",
        "UpdateSourceData":"https://github.com/citizenfx/cfx-server-data.git",
        "UpdateSourceTarget":"{{$FullBaseDir}}server-data"
    },
    {
        "UpdateStageName":"Server.cfg Template Download",
        "UpdateSourcePlatform":"All",
        "UpdateSource":"FetchURL",
        "UpdateSourceData":"https://raw.githubusercontent.com/Greelan/AMPTemplates/dev/fivemserver.cfg",
        "UpdateSourceArgs":"AMP_server.cfg",
        "UpdateSourceTarget":"{{$FullInstanceDir}}",
        "OverwriteExistingFiles":true
    }
]
