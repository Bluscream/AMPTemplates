[
    {
        "UpdateStageName":"SteamCMD Download",
        "UpdateSourcePlatform":"All",
        "UpdateSource":"SteamCMD",
        "UpdateSourceData":"1829350",
        "UpdateSourceArgs":"1604030",
        "ForceDownloadPlatform":"Windows"
    },
    {
        "UpdateStageName":"Data Directory Creation",
        "UpdateSourcePlatform":"All",
        "UpdateSource":"CreateDirectory",
        "UpdateSourceArgs":"{{$FullBaseDir}}save-data/Settings"
    },
    {
        "UpdateStageName":"Game Config File Copy",
        "UpdateSourcePlatform":"All",
        "UpdateSource":"CopyFilePath",
        "UpdateSourceData":"{{$FullBaseDir}}save-data/Settings/ServerHostSettings.json",
        "UpdateSourceArgs":"{{$FullBaseDir}}VRisingServer_Data/StreamingAssets/Settings/ServerHostSettings.json",
        "OverwriteExistingFiles":false
    },
    {
        "UpdateStageName":"Game Config File Copy",
        "UpdateSourcePlatform":"All",
        "UpdateSource":"CopyFilePath",
        "UpdateSourceData":"{{$FullBaseDir}}save-data/Settings/ServerGameSettings.json",
        "UpdateSourceArgs":"{{$FullBaseDir}}VRisingServer_Data/StreamingAssets/Settings/ServerGameSettings.json",
        "OverwriteExistingFiles":false
    },
    {
        "UpdateStageName":"Download BepInEx From Thunderstore",
        "UpdateSourcePlatform":"All",
        "UpdateSource":"FetchURL",
        "UpdateSourceData":"https://v-rising.thunderstore.io/package/download/BepInEx/BepInExPack_V_Rising/1.0.0/",
        "UpdateSourceArgs":"BepInEx-BepInExPack_V_Rising-1.0.0.zip",
        "UpdateSourceTarget":"{{$FullBaseDir}}",
        "UpdateSourceConditionSetting":"BepInExVersion",
        "UpdateSourceConditionValue":"release",
        "UnzipUpdateSource":true,
        "OverwriteExistingFiles":true,
        "DeleteAfterExtract":true
    },
    {
        "UpdateStageName":"BepInEx Copy",
        "UpdateSourcePlatform":"Windows",
        "UpdateSource":"Executable",
        "UpdateSourceData":"cmd.exe",
        "UpdateSourceArgs":"/C xcopy /E /Y /I v-rising\\1829350\\BepInExPack_V_Rising\\* v-rising\\1829350\\ && rmdir /Q /S v-rising\\1829350\\BepInExPack_V_Rising",
        "UpdateSourceConditionSetting":"BepInExVersion",
        "UpdateSourceConditionValue":"release"
    },
    {
        "UpdateStageName":"BepInEx Copy",
        "UpdateSourcePlatform":"Linux",
        "UpdateSource":"Executable",
        "UpdateSourceData":"/bin/bash",
        "UpdateSourceArgs":"-c '\\cp -rf ./v-rising/1829350/BepInExPack_V_Rising/* ./v-rising/1829350/ && rm -rf ./v-rising/1829350/BepInExPack_V_Rising/'",
        "UpdateSourceConditionSetting":"BepInExVersion",
        "UpdateSourceConditionValue":"release"
    },
    {
        "UpdateStageName":"Download BepInEx From GitHub",
        "UpdateSourcePlatform":"All",
        "UpdateSource":"FetchURL",
        "UpdateSourceData":"https://github.com/decaprime/VRising-Modding/releases/download/1.668.4/BepInEx_V_Rising_Experimental_Dev_1.668.4.zip",
        "UpdateSourceTarget":"{{$FullBaseDir}}",
        "UnzipUpdateSource":true,
        "OverwriteExistingFiles":true,
        "DeleteAfterExtract":true,
        "UpdateSourceConditionSetting":"BepInExVersion",
        "UpdateSourceConditionValue":"experimental"
    },
    {
        "UpdateStageName":"Download BepInEx From GitHub",
        "UpdateSourcePlatform":"All",
        "UpdateSource":"FetchURLFromJQ",
        "UpdateSourceData":"https://api.github.com/repos/decaprime/VRising-Modding/releases",
        "UpdateSourceArgs":".[0].assets[0].browser_download_url",
        "UpdateSourceTarget":"{{$FullBaseDir}}",
        "UnzipUpdateSource":true,
        "OverwriteExistingFiles":true,
        "DeleteAfterExtract":true,
        "UpdateSourceConditionSetting":"BepInExVersion",
        "UpdateSourceConditionValue":"placeholder"
    },
    {
        "UpdateStageName":"BepInEx Copy",
        "UpdateSourcePlatform":"Windows",
        "UpdateSource":"Executable",
        "UpdateSourceData":"cmd.exe",
        "UpdateSourceArgs":"/C move /Y v-rising\\1829350\\BepInEx_V_Rising_Experimental_Dev* v-rising\\1829350\\BepInEx_V_Rising_Experimental_Dev && xcopy /E /Y /I v-rising\\1829350\\BepInEx_V_Rising_Experimental_Dev\\* v-rising\\1829350\\ && rmdir /Q /S v-rising\\1829350\\BepInEx_V_Rising_Experimental_Dev",
        "UpdateSourceConditionSetting":"BepInExVersion",
        "UpdateSourceConditionValue":"experimental"
    },
    {
        "UpdateStageName":"BepInEx Copy",
        "UpdateSourcePlatform":"Linux",
        "UpdateSource":"Executable",
        "UpdateSourceData":"/bin/bash",
        "UpdateSourceArgs":"-c 'find ./v-rising/1829350/ -maxdepth 1 -type d -name \"BepInEx_V_Rising_Experimental_Dev*\" -execdir mv {} BepInEx_V_Rising_Experimental_Dev > {{$FullBaseDir}}AMPSetupLog.txt 2>&1 \\; && \\cp -rf ./v-rising/1829350/BepInEx_V_Rising_Experimental_Dev/* ./v-rising/1829350/ && rm -rf ./v-rising/1829350/BepInEx_V_Rising_Experimental_Dev/'",
        "UpdateSourceConditionSetting":"BepInExVersion",
        "UpdateSourceConditionValue":"experimental"
    },
    {
        "UpdateStageName":"Initialise Wine",
        "UpdateSourcePlatform":"Linux",
        "UpdateSource":"Executable",
        "UpdateSourceData":"/bin/bash",
        "UpdateSourceArgs":"-c 'WINEPREFIX=\"{{$FullRootDir}}.wine\" WINEARCH=win64 /usr/bin/wineboot --init --update'"
    },
    {
        "UpdateStageName":"Install Dotnet 6",
        "UpdateSourcePlatform":"Linux",
        "UpdateSource":"Executable",
        "UpdateSourceData":"/bin/bash",
        "UpdateSourceArgs":"-c 'cd {{$FullRootDir}} && wget -N https://raw.githubusercontent.com/Winetricks/winetricks/master/src/winetricks > {{$FullBaseDir}}AMPSetupLog.txt 2>&1 && chmod +x ./winetricks >> {{$FullBaseDir}}AMPSetupLog.txt 2>&1 && env WINEPREFIX=\"{{$FullRootDir}}.wine\" WINEARCH=win64 && /usr/bin/xvfb-run -a {{$FullRootDir}}winetricks corefonts dotnet6 >> {{$FullBaseDir}}AMPSetupLog.txt 2>&1'",
        "UpdateSourceConditionSetting":"BepInExVersion",
        "UpdateSourceConditionValue":"experimental"
    }
]
